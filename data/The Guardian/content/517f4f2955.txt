The Indian government has enacted a divisive citizenship law that critics say discriminates against Muslims, just weeks before prime minister Narendra Modi heads into a general election.

The law, known as the citizenship amendment act (CAA), was one of the most controversial pieces of legislation proposed by the Modi government after it explicitly made religion the basis on which people could become Indian citizens.

Under the law, Hindus, Parsis, Sikhs, Buddhists, Jains and Christians who entered India from Pakistan, Afghanistan and Bangladesh before December 2014 are allowed on to a fast track to Indian nationality. However Muslims are not granted the same right.

Though the law was passed in December 2019, its implementation was delayed after widespread protests and deadly violence erupted in which thousands were arrested and more than 100 people were reported to have been killed.

Many of the lawyers, activists and citizens who took to the streets had voiced concern that CAA undermined India’s secular foundations, as enshrined in the constitution, and legitimised discrimination against Muslims under the law. Many had also claimed that the law was unnecessary, as these minorities were already eligible for citizenship.

The Hindu nationalist Bharatiya Janata Party (BJP) government had pledged that the law would come into force before the election, which is expected in mid-April, and in which Modi is widely predicted to win a third term in power.

Late on Monday night, the ministry of home affairs announced that the CAA had been enacted. “These rules will now enable minorities persecuted on religious grounds in Pakistan, Bangladesh and Afghanistan to acquire citizenship in our nation,” said home minister Amit Shah.

Shah said Modi had “delivered on another commitment and realised the promise of the makers of our constitution to the Hindus, Sikhs, Buddhists, Jains, Parsis and Christians living in those countries”.

After the announcement, Amnesty International called CAA “a discriminatory law that goes against the constitutional values of equality and international human rights law”.

Several chief ministers in states ruled by opposition parties, such as West Bengal and Tamil Nadu, had pledged they would not implement CAA in their states. However, under the new rules, state governments will have little say in the application process, which will largely be under the central government.

On Monday night, heavy security and paramilitary forces were deployed across north-east Delhi, the site of sustained protests against CAA in 2019 and 2020.

Many among India’s 200 million Muslims fear the law is a precursor to a national register of citizens that could leave them stateless in the country of 1.4 billion. Many poor Indians do not have documents to prove their nationality.

This was denied by the Modi government, who stated that Muslims are not covered by the legislation because they do not need India’s protection.

However minority Muslim groups who are persecuted in neighbouring countries, such as Rohingya Muslims and Hazara Shias, are not eligible under CAA, and neither are migrants from non-Muslim countries fleeing persecution to India, including Tamil refugees from Sri Lanka and Tibetan Buddhists fleeing China’s rule.

Besides stoking concern among Muslims, the proposed changes also sparked protests by residents in states such as Assam who are fearful of an influx of Hindus from Bangladesh, which they say will be a threat to their culture.

After the legislation was enacted, indigenous rights and student groups in Assam held protests on Monday night at which they burned copies of the new legislation. “The CAA is not acceptable to us. The BJP government has today delivered the biggest blow to the Assamese people, our identity, and our culture. Our protest will continue,” said the Samujjal Kumar Bhattacharjya, a leader of the All Assam students’ union.

